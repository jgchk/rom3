// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model Scene {
  id                 Int              @id @default(autoincrement())
  name               String
  alternateNames     SceneName[]
  shortDesc          String           @db.VarChar(255)
  longDesc           String           @db.Text
  influencesScenes   SceneInfluence[] @relation("SceneInfluencer")
  influencedByScenes SceneInfluence[] @relation("SceneInfluenced")
}

model SceneName {
  scene   Scene  @relation(fields: [sceneId], references: [id])
  sceneId Int
  name    String

  @@id([sceneId, name])
}

model SceneInfluence {
  influencer   Scene @relation("SceneInfluencer", fields: [influencerId], references: [id])
  influencerId Int
  influenced   Scene @relation("SceneInfluenced", fields: [influencedId], references: [id])
  influencedId Int

  @@id([influencerId, influencedId])
}

model Style {
  id                 Int                   @id @default(autoincrement())
  name               String
  alternateNames     StyleName[]
  shortDesc          String                @db.VarChar(255)
  longDesc           String                @db.Text
  parentStyles       StyleParent[]         @relation("StyleChild")
  childStyles        StyleParent[]         @relation("StyleParent")
  childTrends        TrendStyleParent[]    @relation("TrendStyleParent")
  influencedByStyles StyleInfluence[]      @relation("StyleInfluenced")
  influencesStyles   StyleInfluence[]      @relation("StyleInfluencer")
  influencesTrends   TrendStyleInfluence[] @relation("TrendStyleInfluencer")
}

model StyleName {
  style   Style  @relation(fields: [styleId], references: [id])
  styleId Int
  name    String

  @@id([styleId, name])
}

model StyleParent {
  parent   Style @relation("StyleParent", fields: [parentId], references: [id])
  parentId Int
  child    Style @relation("StyleChild", fields: [childId], references: [id])
  childId  Int

  @@id([parentId, childId])
}

model StyleInfluence {
  influencer   Style @relation("StyleInfluencer", fields: [influencerId], references: [id])
  influencerId Int
  influenced   Style @relation("StyleInfluenced", fields: [influencedId], references: [id])
  influencedId Int

  @@id([influencerId, influencedId])
}

model Trend {
  id                 Int                   @id @default(autoincrement())
  name               String
  alternateNames     TrendName[]
  shortDesc          String                @db.VarChar(255)
  longDesc           String                @db.Text
  parentTrends       TrendTrendParent[]    @relation("TrendTrendChild")
  parentStyles       TrendStyleParent[]    @relation("TrendStyleChild")
  childTrends        TrendTrendParent[]    @relation("TrendTrendParent")
  influencedByTrends TrendTrendInfluence[] @relation("TrendTrendInfluenced")
  influencedByStyles TrendStyleInfluence[] @relation("TrendStyleInfluenced")
  influencesTrends   TrendTrendInfluence[] @relation("TrendTrendInfluencer")
}

model TrendName {
  trend   Trend  @relation(fields: [trendId], references: [id])
  trendId Int
  name    String

  @@id([trendId, name])
}

model TrendTrendParent {
  parent   Trend @relation("TrendTrendParent", fields: [parentId], references: [id])
  parentId Int
  child    Trend @relation("TrendTrendChild", fields: [childId], references: [id])
  childId  Int

  @@id([parentId, childId])
}

model TrendStyleParent {
  parent   Style @relation("TrendStyleParent", fields: [parentId], references: [id])
  parentId Int
  child    Trend @relation("TrendStyleChild", fields: [childId], references: [id])
  childId  Int

  @@id([parentId, childId])
}

model TrendTrendInfluence {
  influencer   Trend @relation("TrendTrendInfluencer", fields: [influencerId], references: [id])
  influencerId Int
  influenced   Trend @relation("TrendTrendInfluenced", fields: [influencedId], references: [id])
  influencedId Int

  @@id([influencerId, influencedId])
}

model TrendStyleInfluence {
  influencer   Style @relation("TrendStyleInfluencer", fields: [influencerId], references: [id])
  influencerId Int
  influenced   Trend @relation("TrendStyleInfluenced", fields: [influencedId], references: [id])
  influencedId Int

  @@id([influencerId, influencedId])
}
